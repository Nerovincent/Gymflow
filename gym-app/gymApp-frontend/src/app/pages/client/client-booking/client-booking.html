<div class="max-w-7xl mx-auto px-4">

  <a
    routerLink="/client"
    class="text-sm text-primary hover:text-primary-focus mb-4 inline-block transition-colors"
  >
    ← Back to Trainers
  </a>

  <h2 class="text-2xl font-bold mb-6">
    Book a Session
  </h2>

  <!-- Week Picker -->
  <div class="mb-8">
    <label class="block text-sm font-medium mb-2">
      Select Week
    </label>
    <input
      type="date"
      class="input input-bordered w-full max-w-xs focus:border-primary"
      [(ngModel)]="selectedDate"
      (change)="loadWeekSlots()"
    />
  </div>

  <!-- Booking Grid -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4">

    <div
      *ngFor="let day of weekSlots"
      class="card bg-base-100 shadow-xl border border-base-300"
    >
      <div class="card-body p-4">
        <!-- Date Header -->
        <div class="text-center mb-3 pb-3 border-b border-base-300">
          <p class="text-xs opacity-60 uppercase tracking-wide font-semibold">
            {{ day.date | date:'EEE' }}
          </p>
          <p class="text-xl font-bold mt-1">
            {{ day.date | date:'MMM d' }}
          </p>
        </div>

        <!-- Slots -->
        <ng-container *ngIf="day.slots.length > 0; else noSlots">
          <button
            *ngFor="let slot of day.slots"
            class="btn btn-sm btn-primary btn-outline mb-2 text-xs hover:btn-primary transition-all"
            (click)="openConfirmModal(slot)"
          >
            {{ slot.startTime }} – {{ slot.endTime }}
          </button>
        </ng-container>

        <ng-template #noSlots>
          <p class="text-center text-xs opacity-50 mt-6 italic">
            No available slots
          </p>
        </ng-template>
      </div>
    </div>

  </div>
</div>

<!-- ================= BOOKING CONFIRMATION MODAL ================= -->
<div *ngIf="showConfirmModal" class="modal modal-open">
  <div class="modal-box">

    <h3 class="font-bold text-xl mb-6">
      Confirm Booking
    </h3>

    <div class="space-y-4 mb-6">
      <div class="bg-base-200 rounded-lg p-4">
        <p class="text-xs opacity-60 uppercase tracking-wide mb-1 font-semibold">
          Date
        </p>
        <p class="text-lg font-semibold">
          {{ selectedDate | date:'fullDate' }}
        </p>
      </div>

      <div class="bg-base-200 rounded-lg p-4">
        <p class="text-xs opacity-60 uppercase tracking-wide mb-1 font-semibold">
          Time
        </p>
        <p class="text-lg font-semibold">
          {{ selectedSlot?.startTime }} – {{ selectedSlot?.endTime }}
        </p>
      </div>
    </div>

    <div class="modal-action">
      <button
        class="btn btn-ghost"
        (click)="closeConfirmModal()"
      >
        Cancel
      </button>

      <button
        class="btn btn-primary"
        (click)="confirmBooking()"
      >
        Confirm Booking
      </button>
    </div>

  </div>
</div>